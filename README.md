Padawan.vim for php
====================

Smart php intelligent code completion plugin. It tries to be 
a [Jedi](https://github.com/davidhalter/jedi-vim), but currently 
it's only a padawan.

This plugin is a fork of 
[phpcomplete-extended by M2mdas](https://github.com/m2mdas/phpcomplete-extended) 
with completely rewritten index generation part. 
New index generator based on [nikic/PHP-Parser](https://github.com/nikic/PHP-Parser).

Currently it's under development and does not support some of the original 
plugin features.

Plugin
======

Padawan.vim  reads autoload classmap of a composer
project, parses doc-comments and functions declarations of each class and creates index 
from them. After that it auto updates index as you type thanks to
[vimproc.vim](https://github.com/Shougo/vimproc.vim) plugin. Besides
autocomplete this plugin have several code inspection features:

* See documentation of current word, be it class name, method or property. It is
  context aware.
* Go to definition of a symbol. Also context aware.
* Automatically add use statement of current completed word. Also added plugin
  command of this action.

Demo videos (click on the image to goto youtube) by M2mdas
----------------------------------------------------------
## Autocomplete demo video:

[![ScreenShot](http://img.youtube.com/vi/yZYFKslqkC8/maxresdefault.jpg)](http://www.youtube.com/watch?v=yZYFKslqkC8)


Installation
-------------

The plugin depends on following plugins:

*  php 5.4+
*  [vimproc.vim](https://github.com/Shougo/vimproc.vim) : Asynchronous library for vim. Required for auto-update index. C
  compiler is needed to build the plugiin. For windows install cygwin or
  msys to get the compiler.

Plugin managers are recommended for installing these plugins. Installation instructions for
various plugin managers are given bellow.

## Pathogen
 
You should manually install vimproc.vim!
Issue following commands.

```sh
git clone https://github.com/mkusher/padawan.vim ~/.vim/bundle/padawan.vim
```

## NeoBundle (preferred)

You should manually install vimproc.vim!
Put these lines in `.vimrc` and issue `source %` command

```vim
NeoBundle 'mkusher/padawan.vim', { 'build': {'unix': 'php /path/to/composer.phar install'} }
"your other plugins
NeoBundleCheck
```

You should have composer.phar installed.

## Vundle

You should manually install vimproc.vim!
Put following lines in `.vimrc` and issue `:BundleInstall` command.
```vim
Bundle 'mkusher/padawan.vim'
"your other plugins
"....
```

After installation goto `padawan.vim` folder and run 
`php /path/to/composer.phar install` command from command
line. You should have composer installed.

Walk through of the plugin
-------------------------

To enable omni complete add following line to `.vimrc`,

    autocmd  FileType  php setlocal omnifunc=phpcomplete_extended#CompletePHP

Then issuing `<C-X><C-O>` in insert mode will open the completion pop-up menu.

This plugin is tested in Windows and Linux. It should work in OSX also.

For now this plugin supports [Composer](http://getcomposer.org/) PHP projects.
Upon detecting a composer project the plugin scans classmap generated by `php
composer.phar dumpautoload --optimize` command. By default composer command is
set to `php composer.phar`. The command can be changed by setting
`g:phpcomplete_index_composer_command` global variable.

The plugin is dependent on `@var`, `@param`, `@return` doc-comments and class 
declarations to give proper context aware
autocomplete. So documenting your class will help tremendously. It does not
analyse full class. Just parses the variable declaration to get the relevant
tokens. Does not provide autocomplete suggestion if there is error in code.

Indexing may take some time depending on project size. To decrease index creation time I
would recommend disabling xdebug extension in cli. To do that go to the location
where `php.ini` resides and copy the `php.ini` file as `php-cli.ini` and comment
out the xdebug line. To verify issue `php -m | grep xdebug` in commandline.

For configuration reference see helpdoc.


Auto complete plugin supports
-----------------------------

## [neocomplete](https://github.com/Shougo/neocomplete.vim)

Neocomplete support is built-in and my preferred autocomplete plugin. It needs
vim with lua bindings. To know more about installation refer to the plugin
repository.

## [supertab](https://github.com/ervandew/supertab)

Minimal configuration for supertab support,

    autocmd  FileType  php setlocal omnifunc=phpcomplete_extended#CompletePHP
    let g:SuperTabDefaultCompletionType = "<c-x><c-o>"

## [YouCompleteMe](https://github.com/Valloric/YouCompleteMe)

If `omnifunc` set the omni completer of `YouCompleteMe` should get the completion
candidates. You should check semantic trigers for php.

Why not original plugin
-----------------------

The M2mdas's plugin is pretty good, but have some core bugs due to
self-written parser:

* It does not support files with 2 or more classes in it
* It fails on parsing RabbitMQ classes

So, I decided to rewrite index generation part.

Roadmap
-------

As of now this plugin sucks, but I'm working hard on it and these features are
now in progress:

* Fix bugs with symbol type detection
* Fix plugin user interface
* Add doc-comment parsing
* Add class inheritance indexing
* Add plugins support
* Add symfony2 plugin

License
-------
MIT licensed.

Acknowledgement
---------------

This plugin would not be possible without the works of
[M2mdas](https://github.com/m2mdas),
[Shougo](https://github.com/Shougo),
[shawncplus](https://github.com/shawncplus/),
[tpope](https://github.com/tpope/), [vim-jp](https://github.com/vim-jp),
[thinca](https://github.com/thinca) and many others.
